## Brecon Project Review


Site publication: <http://brecon.newtfire.org>

GitHub: <https://github.com/haggis78/BreconChurch>

Developers:
* William Campbell: @haggis78
* Amber Peddicord: @amberpeddicord 
* Connor Chinoy: @ChinoyIndustries

Date of Evaluation: 2019-12-23

Evaluated by: @ebeshero


### General 
This is an ambitious project to compare the available manuscripts documenting the origins of the Brecon Collegiate Church and School, and to find evidence of an original, now missing, first source. The team has constructed an interface for selecting sources to read side-by-side as well as a number of charts and visualizations to examine how eight source documents compare and diverge. 

### Research questions and goals
The primary research question is well described on the [Methodology page](http://brecon.newtfire.org/html/methodology.html) as a "line-by-line comparison of all of the surviving copies" to find out how the documentation about the church school was being shared and altered over time, and to construct a *stemma codicum* or "family tree" of the available manuscripts perhaps to help understand the missing original document. Perhaps a secondary research goal might be the sharing of information about this church school for those interested in Welsh history more generally.

### Technologies

#### TEI
All team members gained much experience with studying the [TEI Guidelines](https://www.tei-c.org/release/doc/tei-p5-doc/en/html/index.html) in the process of customizing them for the project. The team developed an ODD document to adapt the TEI-All schema and in the process made important decisions to ensure consistency in the encoding methods so that it was clear what kinds of textual alterations are meaningful to document in a critical apparatus, which is the primary means of marking differences among source texts called "witnesses" in the TEI. A single TEI document containing the textual comparison data is one of the key deliverables of this project, and though this is available as [CharterCollation.xml](https://github.com/haggis78/BreconChurch/blob/master/xml/CharterCollation.xml) for people who know how to find their way around a GitHub repo linked to the project website, we strongly recommend that you make that TEI document available from the website for download (perhaps on a Coding Methodology page about which we'll speak below). 

Much of the documentation on site relies on audience members to know about TEI as well as XPath function names for exploring it (as we note the reference to the `count()` function on one of the graph pages. That's okay for our in-house coding community, but not all Welsh scholars or medieval historians will be familiar with these terms, so we recommend finding some other language to use that refrains from TEI and XML-stack jargon. Anonymous block is TEI lingo, but also pretty important in the project. You may want to find a more generic word for it, like sections or units of text, and explain somewhere what that means. And of course you may use TEI and XML jargon on your site, but find a place to do it that speaks directly and specifically to members of the coding community. Perhaps such discussion belongs on a distinct TEI Coding Methodology page. 

#### XPath and XSLT
The TEI has been explored with XPath and transformed with XSLT to produce much analysis of which of the source documents most agree, and to highlight exactly where they diverge, and to explore this data quantitatively in a number of ways, some of them more legibly than others. We'll look at them one by one: 

1. Maybe the easiest of these quantitative analyses for a determined manuscript scholar to follow and understand is on the [Textual Analysis page](http://brecon.newtfire.org/html/TextualAnalysis.html) which  contains tables showing how freqently each witness compares with the others (and showing also how it compares with its own self as a maximum point of agreement). The documentation of these tables is a bit rough to read at this moment and needs a little editing, but the meaning of the tables is pretty clear.  These data can be expressed and visualized in a number of ways. Consider instead of a raw count, a proportion: For witness "R" which contains 268 moments of potential disagreement, witness W agrees 139 out of 268 possible times. That can be expressed and plotted as a percentage in a chart form or in bar plots. @djbpitt's idea to express these data as a **network analysis** is a good one, and one we can explore during the spring Coding and Data Visualization class which has a unit on network graphing. Here the idea is to use computational tools to plot tabular data like this, and a network graph could visualize each witness a circular node and show how relatively frequently it agrees with each of the other nodes by thin or thick connecting lines. [An example of this applied to what source witnesses share in common](http://dickinson.newtfire.org/16/networkAnalysis.html) is plotted by the developers of the Emily Dickinson project (from their time in the spring Coding and Data Viz class). We definitely recommend that returning members of the Brecon team try to plot a network graph as a way provide a legible comparison view, to be complemented (and perhaps even simply fed by) these data tables.
1. The [Variations per Anonymous Block graph](http://brecon.newtfire.org/html/Graphs.html) represents another holistic perspective on the data, looking at all the witnesses together to note which *portion* of the TEI document contains the most quantity of marked alterations. The explanation next to this graph indicates dissatisfaction with its lack of proportionality because it is based on raw counts of `<app>` elements that do not take into account the different lengths of each "anonymous block" (or "unit chunk") of text. One way to prepare a more proportional view might be to use the XPath `string-length()` function, perhaps combined with the `max()` function like this: 

     * Every `<app>` contains `<rdg>` elements of different lengths, so you might see if you can find the longest string-length of any `<rdg>` within each `<app>` element. An XPath expression for that looks something like `//ab//app/(rdg ! string-length() => max())`. (The parentheses make a grouping to evaluate the longest string-length of any `<rdg>` element within each of the 268 app elements in the document, but it's not quite what we want.)
     * In XSLT you can handle this with an XSL template match or an XSL for-each group to stop on each of your 25 `<ab>` elements, and retrieve all the maximum string-lengths, and add them up. (You can make a local variable in XSLT, wherever you are processing each `<ab>` element that contains a sequence of all the longest `<rdg>` string-lengths in each descendant app. 
     * Make another local variable to send that sequence to the `sum()` function. This would deliver a single value for each `<ab>` element: the sum total of the lengths of its longest `<rdg>` elements. (That's just one number summing up the longest content in any available variant reading.)
     * Make one more local variable to get the total string-length of the entire `<ab>` element, so you have its proportion, something like `//ab/string-length()` . Or if you want to get this just right, make a variable to hold the `string-length()` of all the content *not* part of an `<app>`, and add to it your variable holding the sum of just the maximum rdg string-length.  That's your total value, to help give you a sense of proportion.
     * Divide the sum of your longest rdg elements by your total string-length value of the entire `<ab>`, and you will create a ratio that you can convert into a percentage (multiply by 100). That way you can see whether roughly 25% of a given `<ab>` is holding variant content, judging by the longest string-lengths available. 
     * If you don't quite like representing this via the longest ( `max()` ) variants, you could use the `avg()` or `median()` XPath function to get the average or median lengths. (And you could try different combinations). 
     
1. @alnopa9 worked intensively on the interesting challenge of representing a running stream of numerical data for every witness's variant passages based on string-lengths and word counts (likely based on using the XPath `tokenize()` function to count all the white spaces between words). This produces a rainbowed wall of numbers, and some difficult-to-manage plots per each of your 25 blocks of text. While we know this was a lot of work, we're sure there will be a simpler way of rendering these data to make it more useful for human readers, perhaps by calculating and plotting proportions as we suggest above. Raw counts might be useful to survey internally within the project, but they need to be processed and synthesized with a sense of proportion and scale, and by contrast with raw counts, percentage values will simply be easier to read *and* plot for each each witness, just as they would be for maximum, average, or median values. 
    

#### SVG
SVG Timeline is a fine accomplishment in working with scaling time data, and we hope you will continue to tinker with it as @djbpitt suggests in [his review](https://github.com/haggis78/BreconChurch/issues/37), to see how it might look as a horizontal display without scrolling(!) There will be a way to do this at scale, with visible labels available on mouseover, even if they must by necessity overlap in the space on the page. That's an interesting little "next-level-up" challenge to attempt that will make a glimpse of the whole time span immediately available to the viewer's eye. 

[Variations per Anonymous Block graph](http://brecon.newtfire.org/html/Graphs.html): We notice you have 25 `<ab>` elements in the CharterCollation.xml file, each containing a number of variants, so we're not sure why we're not seeing past the 17th block on the graph?  We'd recommend revisiting the CSS on this graph page anyway to position the text discussion beneath the graph. 

[The Edition-SVG page](http://brecon.newtfire.org/html/edition-svg.html) is a challenge to the reader that really needs more explanation of what's to be found here. In Chrome we still find that the numbers in the SVG tables are blanked out when they're 0s, though that's not an issue in other browsers, and we're still not sure what is causing that. Scaling on the page is a serious issue, about which, [see @djbpitt's comments](https://github.com/haggis78/BreconChurch/issues/37). But we would caution that this data can be processed more simply to provide a better sense of scale and proportion (see our comments above). 

#### Image processing
The [Patent-Collection page](http://brecon.newtfire.org/html/patent-collection.html) contains a wonderfully legible view of your Patent Roll ms, based on batch image reduction via [the command line software Image Magick](https://imagemagick.org/index.php). We're impressed that you labelled the line numbers on each image (and hope that's an Image Magick feature as well)! We'd like to see you work on linking to these images perhaps one by one directly from a reading view, and given the way these are segmented, we could imagine them being made visible immediately within the reading view page. (Perhaps to do this you'll need to add some markup to indicate with `<lb/>` the number of a Patent Roll line at specific locations, and give it a `@facs` attribute to point to the image file URL.) Let's talk more about some simple ways to accomplish this. 


### GitHub
Your GitHub repo is well organized and easy to navigate. It was very active throughout the semester, and you may find [the moments of peak activity](https://github.com/haggis78/BreconChurch/graphs/code-frequency) interesting to look at now that the semester is over. Not all team members were equally engaged on this project, and not all received the same project grade as a result. However, on the whole we were pleased to see the project repo serve as a site of good, clear documentation for project decisions and a means to keep the team in contact and in mostly reliable communication.


###  “UX”: User Experience and Site Interface
Much of our commentary on the user experience of the SVG graphs and analysis is covered in preceding sections, so we will here concentrate mainly on the overall appearance and navigability of the project site. To this point, the site seems primarily designed to appeal to a fairly distinct audience of people who know about TEI and XML. To appeal more broadly (to medievalists who don't code for example) may be a little challenging but we are sure you can do this! Think about, first of all, some pictures for the site: Why do we not see a picture of the Brecon Collegiate Church and School, and some of its interior spaces? Perhaps a page might be designed (or you might find a place to link out to) something to discuss life and subjects studied in collegiate church schools. We do find related scholarly resources linked from the [People page](http://brecon.newtfire.org/html/BreconPeople.html#fn1) but these links are going into databases and sometimes aren't immediately accessible. Also, we'd recommend every link down to a footnote go back up again to its specific "point of departure"--the footnote symbol in the main document. 

The [Witness Comparison reading views](http://brecon.newtfire.org/html/comparison.html) were cleverly designed with CSS and JavaScript to give you a three-fold partition and an opportunity to choose any witness to compare. We'd *also* recommend trying a different strategy to prepare a comparative reading view your source documents, following @djbpitt's suggestion to try outputting your data in collation tables something like his collation tables in [the Rus' Chronicle project](http://pvl.obdurodon.org/pvl.html). We would need to look carefully at your TEI markup to think about how that could work. One complicating factor is that we used TEI parallel segmentation, so that where there is no `<app>` element you have no variance on a given passage. (In @djbpitt's work, he represents all witnesses distinctly whether they run in unison or not, so all content is typically output for him in `<app>` elements, and it's usual for him to think in terms of tabular representations.) In my own work, I tend to use the parallel segmentation that you did, and it's still possible to generate alignment tables when your passages aren't very long. XSLT gives us lots of options for processing content, and we can even output special tables to show passages that run in unison, followed by tables that hold the divergent materials. 

I'd be happy to experiment with you on this alternative tabular layout to see if it makes sense. The way it begins is with an XSLT for-each that loops over each source "witness", and selects for it all the content that's outside `<app>` elements together with all the content for that particular witness. And output each section in a table row belonging to that particular witness. With such a layout you could by default show all eight witnesses at once, and use JavaScript to remove them one by one. 



### Closing Comments
We've provided lots of commentary here because we know this project will continue and there is much to build on (though perhaps at a speedier pace than the medieval architecture of a cathedral or collegiate school). For fifteen weeks of serious thinking and coding effort, though, we're really impressed with the professional work that you've prepared, and we look forward to continuing to help! Even if some of the current team members go on to work on new projects, I hope that we'll each continue tinkering in some way or other with graphs and visualizations and reading views for the Brecon project. For now, congratulations and bravo on launching such a challenging and wonderfully intricate project this term, and happy holidays! 

